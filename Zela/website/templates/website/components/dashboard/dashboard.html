{% extends 'website/layouts/base.html' %} {% load static %} {% block title%}{{title }}{% endblock %} {% block content %}
<!-- Toast Component -->
{% include 'website/components/toast.html' %}
{% csrf_token %}

<!-- JSON data for JavaScript -->
{{ is_provider|json_script:"is-provider-data" }}
{{ dashboard_data|json_script:"dashboard-data" }}

<div
  class="min-h-screen flex"
  style="background-color: #f5f5f5"
  x-cloak
  x-data="{
       currentTab: JSON.parse(document.getElementById('is-provider-data').textContent) ? 'pro-overview' : 'overview',
       isProviderMode: JSON.parse(document.getElementById('is-provider-data').textContent),
       sidebarOpen: false,
       userDropdownOpen: false,
       user: {
         name: '{% if profile.first_name or profile.last_name %}{{ profile.first_name|default:"" }} {{ profile.last_name|default:"" }}{% elif user.first_name or user.last_name %}{{ user.first_name|default:"" }} {{ user.last_name|default:"" }}{% else %}{{ user.username }}{% endif %}'.trim(),
         email: '{{ user.email|escapejs }}',
         avatar: '{% if profile.profile_picture %}{{ profile.profile_picture.url }}{% else %}{% static "zela-workers-new-photos/madalena-rodrigues-1.jpeg" %}{% endif %}',
         is_provider: JSON.parse(document.getElementById('is-provider-data').textContent),
         provider_verified: false
       },

       dashboardData: JSON.parse(document.getElementById('dashboard-data').textContent),
       showBookingSuccessModal: false,
       init() {
         if (this.user.is_provider && !this.isProviderMode) {
           this.isProviderMode = true;
           this.currentTab = 'pro-overview';
         }
         
         // Check if we need to navigate to a specific tab
         const navigateToTab = sessionStorage.getItem('navigateToTab');
         if (navigateToTab && !this.isProviderMode) {
           this.currentTab = navigateToTab;
           sessionStorage.removeItem('navigateToTab');
         }
         
         if (sessionStorage.getItem('bookingSuccess') === 'true') {
           sessionStorage.removeItem('bookingSuccess');
           // Show modal instead of just toast
           setTimeout(() => {
             this.showBookingSuccessModal = true;
           }, 500);
         }
       },
       getTabDisplayName() {
         const tabNames = {
           'overview': 'Início',
           'bookings': 'Reservas',
           'addresses': 'Localizações',
           'wallet': 'Pagamentos',
           'notifications': 'Notificações',
           'profile': 'Perfil',
           'help': 'Central de Ajuda',
           'pro-overview': 'Início',
           'job-queue': 'Trabalhos',
           'availability': 'Disponibilidade',
           'service-area': 'Área de Serviço (Mapa)',
           'earnings': 'Ganhos e Pagamentos',
           'ratings': 'Avaliações e Comentários',
           'wallet-promos': 'Carteira / Promoções',
           'resources': 'Recursos e Formação',
           'kyc': 'Perfil',
           'settings': 'Configurações'
         };
         return tabNames[this.currentTab] || 'Painel';
       }
     }"
  @keydown.escape="sidebarOpen = false"
>
  <!-- Mobile Sidebar Overlay -->
  <div
    x-show="sidebarOpen"
    x-transition:enter="transition-opacity ease-linear duration-300"
    x-transition:enter-start="opacity-0"
    x-transition:enter-end="opacity-100"
    x-transition:leave="transition-opacity ease-linear duration-300"
    x-transition:leave-start="opacity-100"
    x-transition:leave-end="opacity-0"
    class="fixed inset-0 bg-gray-600 bg-opacity-75 z-40 lg:hidden"
    @click="sidebarOpen = false"
  ></div>

  <!-- Left Sidebar - Responsive -->
  <div
    class="fixed inset-y-0 left-0 z-50 w-80 bg-white shadow-lg transform transition-transform duration-300 ease-in-out lg:translate-x-0 lg:static lg:inset-0 flex flex-col h-screen"
    :class="sidebarOpen ? 'translate-x-0' : '-translate-x-full'"
  >
    <!-- Logo & Title -->
    <div class="p-6 flex-shrink-0">
      <div class="flex items-center justify-between">
        <div class="flex items-center">
          <img
            src="{% static 'zela-logo.png' %}"
            alt="Zela"
            class="h-8 w-auto"
          />
          <h1 class="ml-3 text-xl font-bold" style="color: black">
            Zela
          </h1>
        </div>
        <!-- Close button for mobile -->
        <button
          @click="sidebarOpen = false"
          class="lg:hidden p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 cursor-pointer"
        >
          <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
      </div>
    </div>

    <!-- Mode Switch removed for providers - they only see provider dashboard -->

    <!-- Navigation Menu - Takes remaining space -->
    <nav class="flex-1 px-6 py-4 min-h-0 overflow-y-auto">
      <!-- Customer Tabs -->
      <div x-show="!isProviderMode" class="space-y-1">
        <div class="mb-4">
          <h3 class="text-xs font-semibold text-gray-500 uppercase tracking-wider">
            Painel do Cliente
          </h3>
        </div>

        <button
          @click="currentTab = 'overview'; sidebarOpen = false"
          class="w-full flex items-center px-4 py-3 text-sm font-medium text-left rounded-lg transition-all duration-200 cursor-pointer group"
          :class="currentTab === 'overview' ? 'text-white border-r-4' : 'text-gray-700 hover:bg-gray-50 hover:text-gray-900'"
          :style="currentTab === 'overview' ? 'background-color: #035d73; border-color: #035d73' : ''"
        >
          <svg
            class="mr-3 h-5 w-5 transition-colors duration-200 flex-shrink-0"
            :class="currentTab === 'overview' ? 'text-white' : 'text-gray-400 group-hover:text-gray-600'"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"
            />
          </svg>
          <span class="truncate">Início</span>
        </button>

        <button
          @click="currentTab = 'bookings'; sidebarOpen = false"
          class="w-full flex items-center px-4 py-3 text-sm font-medium text-left rounded-lg transition-all duration-200 cursor-pointer group"
          :class="currentTab === 'bookings' ? 'text-white border-r-4' : 'text-gray-700 hover:bg-gray-50 hover:text-gray-900'"
          :style="currentTab === 'bookings' ? 'background-color: #035d73; border-color: #035d73' : ''"
        >
          <svg
            class="mr-3 h-5 w-5 transition-colors duration-200 flex-shrink-0"
            :class="currentTab === 'bookings' ? 'text-white' : 'text-gray-400 group-hover:text-gray-600'"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"
            />
          </svg>
          <span class="truncate">Reservas</span>
          <span
            x-show="dashboardData.upcomingBookings > 0"
            class="ml-auto text-xs font-medium px-2 py-1 rounded-full flex-shrink-0"
            :class="currentTab === 'bookings' ? 'bg-white text-gray-800' : 'text-white'"
          :style="currentTab === 'bookings' ? '' : 'background-color: #035d73'"
            x-text="dashboardData.upcomingBookings"
          ></span>
        </button>

        <button
          @click="currentTab = 'addresses'; sidebarOpen = false"
          class="w-full flex items-center px-4 py-3 text-sm font-medium text-left rounded-lg transition-all duration-200 cursor-pointer group"
          :class="currentTab === 'addresses' ? 'text-white border-r-4' : 'text-gray-700 hover:bg-gray-50 hover:text-gray-900'"
          :style="currentTab === 'addresses' ? 'background-color: #035d73; border-color: #035d73' : ''"
        >
          <svg
            class="mr-3 h-5 w-5 transition-colors duration-200 flex-shrink-0"
            :class="currentTab === 'addresses' ? 'text-white' : 'text-gray-400 group-hover:text-gray-600'"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"
            />
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M15 11a3 3 0 11-6 0 3 3 0 016 0z"
            />
          </svg>
          <span class="truncate">Localizações</span>
        </button>

        <button
          @click="currentTab = 'wallet'; sidebarOpen = false"
          class="w-full flex items-center px-4 py-3 text-sm font-medium text-left rounded-lg transition-all duration-200 cursor-pointer group"
          :class="currentTab === 'wallet' ? 'text-white border-r-4' : 'text-gray-700 hover:bg-gray-50 hover:text-gray-900'"
          :style="currentTab === 'wallet' ? 'background-color: #035d73; border-color: #035d73' : ''"
        >
          <svg
            class="mr-3 h-5 w-5 transition-colors duration-200 flex-shrink-0"
            :class="currentTab === 'wallet' ? 'text-white' : 'text-gray-400 group-hover:text-gray-600'"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"
            />
          </svg>
          <span class="truncate">Pagamentos</span>
        </button>

        <button
          @click="currentTab = 'profile'; sidebarOpen = false"
          class="w-full flex items-center px-4 py-3 text-sm font-medium text-left rounded-lg transition-all duration-200 cursor-pointer group"
          :class="currentTab === 'profile' ? 'text-white border-r-4' : 'text-gray-700 hover:bg-gray-50 hover:text-gray-900'"
          :style="currentTab === 'profile' ? 'background-color: #035d73; border-color: #035d73' : ''"
        >
          <svg
            class="mr-3 h-5 w-5 transition-colors duration-200 flex-shrink-0"
            :class="currentTab === 'profile' ? 'text-white' : 'text-gray-400 group-hover:text-gray-600'"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"
            />
          </svg>
          <span class="truncate">Perfil</span>
        </button>

        <button
          @click="currentTab = 'help'; sidebarOpen = false"
          class="w-full flex items-center px-4 py-3 text-sm font-medium text-left rounded-lg transition-all duration-200 cursor-pointer group"
          :class="currentTab === 'help' ? 'text-white border-r-4' : 'text-gray-700 hover:bg-gray-50 hover:text-gray-900'"
          :style="currentTab === 'help' ? 'background-color: #035d73; border-color: #035d73' : ''"
        >
          <svg
            class="mr-3 h-5 w-5 transition-colors duration-200 flex-shrink-0"
            :class="currentTab === 'help' ? 'text-white' : 'text-gray-400 group-hover:text-gray-600'"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"
            />
          </svg>
          <span class="truncate">Central de Ajuda</span>
        </button>
      </div>

      <!-- Provider Tabs -->
      <div x-show="isProviderMode" class="space-y-1">
        <div class="mb-4">
          <h3 class="text-xs font-semibold uppercase tracking-wider" style="color: #035d73">
            Painel do Prestador
          </h3>
        </div>

        <button
          @click="currentTab = 'pro-overview'; sidebarOpen = false"
          class="w-full flex items-center px-4 py-3 text-sm font-medium text-left rounded-lg transition-all duration-200 cursor-pointer group"
          :class="currentTab === 'pro-overview' ? 'text-white border-r-4' : 'text-gray-700 hover:bg-gray-50 hover:text-gray-900'"
          :style="currentTab === 'pro-overview' ? 'background-color: #035d73; border-color: #035d73' : ''"
        >
          <svg
            class="mr-3 h-5 w-5 transition-colors duration-200 flex-shrink-0"
            :class="currentTab === 'pro-overview' ? 'text-white' : 'text-gray-400 group-hover:text-gray-600'"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"
            />
          </svg>
          <span class="truncate">Visão Geral</span>
        </button>

        <button
          @click="currentTab = 'job-queue'; sidebarOpen = false"
          class="w-full flex items-center px-4 py-3 text-sm font-medium text-left rounded-lg transition-all duration-200 cursor-pointer group"
          :class="currentTab === 'job-queue' ? 'text-white border-r-4' : 'text-gray-700 hover:bg-gray-50 hover:text-gray-900'"
          :style="currentTab === 'job-queue' ? 'background-color: #035d73; border-color: #035d73' : ''"
        >
          <svg
            class="mr-3 h-5 w-5 transition-colors duration-200 flex-shrink-0"
            :class="currentTab === 'job-queue' ? 'text-white' : 'text-gray-400 group-hover:text-gray-600'"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M9 5H7a2 2 0 00-2 2v6a2 2 0 002 2h2m0 0V9a2 2 0 012-2h2a2 2 0 012 2v6a2 2 0 01-2 2H9V5z"
            />
          </svg>
          <span class="truncate">Fila de Trabalhos</span>
        </button>

        <button
          @click="currentTab = 'availability'; sidebarOpen = false"
          class="w-full flex items-center px-4 py-3 text-sm font-medium text-left rounded-lg transition-all duration-200 cursor-pointer group"
          :class="currentTab === 'availability' ? 'text-white border-r-4' : 'text-gray-700 hover:bg-gray-50 hover:text-gray-900'"
          :style="currentTab === 'availability' ? 'background-color: #035d73; border-color: #035d73' : ''"
        >
          <svg
            class="mr-3 h-5 w-5 transition-colors duration-200 flex-shrink-0"
            :class="currentTab === 'availability' ? 'text-white' : 'text-gray-400 group-hover:text-gray-600'"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"
            />
          </svg>
          <span class="truncate">Disponibilidade e Área de Serviço</span>
        </button>

        <button
          @click="currentTab = 'earnings'; sidebarOpen = false"
          class="w-full flex items-center px-4 py-3 text-sm font-medium text-left rounded-lg transition-all duration-200 cursor-pointer group"
          :class="currentTab === 'earnings' ? 'text-white border-r-4' : 'text-gray-700 hover:bg-gray-50 hover:text-gray-900'"
          :style="currentTab === 'earnings' ? 'background-color: #035d73; border-color: #035d73' : ''"
        >
          <svg
            class="mr-3 h-5 w-5 transition-colors duration-200 flex-shrink-0"
            :class="currentTab === 'earnings' ? 'text-white' : 'text-gray-400 group-hover:text-gray-600'"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1"
            />
          </svg>
          <span class="truncate">Ganhos e Pagamentos</span>
        </button>

        <button
          @click="currentTab = 'service-area'; sidebarOpen = false"
          class="w-full flex items-center px-4 py-3 text-sm font-medium text-left rounded-lg transition-all duration-200 cursor-pointer group"
          :class="currentTab === 'service-area' ? 'text-white border-r-4' : 'text-gray-700 hover:bg-gray-50 hover:text-gray-900'"
          :style="currentTab === 'service-area' ? 'background-color: #035d73; border-color: #035d73' : ''"
        >
          <svg
            class="mr-3 h-5 w-5 transition-colors duration-200 flex-shrink-0"
            :class="currentTab === 'service-area' ? 'text-white' : 'text-gray-400 group-hover:text-gray-600'"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M9 20l-5.447-2.724A1 1 0 013 16.382V5.618a1 1 0 011.447-.894L9 7m0 13l6-3m-6 3V7m6 10l4.553 2.276A1 1 0 0021 18.382V7.618a1 1 0 00-.553-.894L15 4m0 13V4m0 0L9 7"
            />
          </svg>
          <span class="truncate">Área de Serviço (Mapa)</span>
        </button>

        <button
          @click="currentTab = 'ratings'; sidebarOpen = false"
          class="w-full flex items-center px-4 py-3 text-sm font-medium text-left rounded-lg transition-all duration-200 cursor-pointer group"
          :class="currentTab === 'ratings' ? 'text-white border-r-4' : 'text-gray-700 hover:bg-gray-50 hover:text-gray-900'"
          :style="currentTab === 'ratings' ? 'background-color: #035d73; border-color: #035d73' : ''"
        >
          <svg
            class="mr-3 h-5 w-5 transition-colors duration-200 flex-shrink-0"
            :class="currentTab === 'ratings' ? 'text-white' : 'text-gray-400 group-hover:text-gray-600'"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.519 4.674a1 1 0 00.95.69h4.915c.969 0 1.371 1.24.588 1.81l-3.976 2.888a1 1 0 00-.363 1.118l1.518 4.674c.3.922-.755 1.688-1.538 1.118l-3.976-2.888a1 1 0 00-1.176 0l-3.976 2.888c-.783.57-1.838-.197-1.538-1.118l1.518-4.674a1 1 0 00-.363-1.118l-3.976-2.888c-.784-.57-.38-1.81.588-1.81h4.914a1 1 0 00.951-.69l1.519-4.674z"
            />
          </svg>
          <span class="truncate">Avaliações e Comentários</span>
        </button>

        <!-- Wallet / Promos Tab - Temporarily hidden -->
        <!-- <button
          @click="currentTab = 'wallet-promos'; sidebarOpen = false"
          class="w-full flex items-center px-4 py-3 text-sm font-medium text-left rounded-lg transition-all duration-200 cursor-pointer group"
          :class="currentTab === 'wallet-promos' ? 'text-white border-r-4' : 'text-gray-700 hover:bg-gray-50 hover:text-gray-900'"
          :style="currentTab === 'wallet-promos' ? 'background-color: #035d73; border-color: #035d73' : ''"
        >
          <svg
            class="mr-3 h-5 w-5 transition-colors duration-200 flex-shrink-0"
            :class="currentTab === 'wallet-promos' ? 'text-white' : 'text-gray-400 group-hover:text-gray-600'"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"
            />
          </svg>
          <span class="truncate">Wallet / Promos</span>
        </button> -->

        <button
          @click="currentTab = 'resources'; sidebarOpen = false"
          class="w-full flex items-center px-4 py-3 text-sm font-medium text-left rounded-lg transition-all duration-200 cursor-pointer group"
          :class="currentTab === 'resources' ? 'text-white border-r-4' : 'text-gray-700 hover:bg-gray-50 hover:text-gray-900'"
          :style="currentTab === 'resources' ? 'background-color: #035d73; border-color: #035d73' : ''"
        >
          <svg
            class="mr-3 h-5 w-5 transition-colors duration-200 flex-shrink-0"
            :class="currentTab === 'resources' ? 'text-white' : 'text-gray-400 group-hover:text-gray-600'"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
            />
          </svg>
          <span class="truncate">Recursos e Formação</span>
        </button>

        <button
          @click="currentTab = 'kyc'; sidebarOpen = false"
          class="w-full flex items-center px-4 py-3 text-sm font-medium text-left rounded-lg transition-all duration-200 cursor-pointer group"
          :class="currentTab === 'kyc' ? 'text-white border-r-4' : 'text-gray-700 hover:bg-gray-50 hover:text-gray-900'"
          :style="currentTab === 'kyc' ? 'background-color: #035d73; border-color: #035d73' : ''"
        >
          <svg
            class="mr-3 h-5 w-5 transition-colors duration-200 flex-shrink-0"
            :class="currentTab === 'kyc' ? 'text-white' : 'text-gray-400 group-hover:text-gray-600'"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"
            />
          </svg>
          <span class="truncate">Perfil</span>
        </button>

        <button
          @click="currentTab = 'settings'; sidebarOpen = false"
          class="w-full flex items-center px-4 py-3 text-sm font-medium text-left rounded-lg transition-all duration-200 cursor-pointer group"
          :class="currentTab === 'settings' ? 'text-white border-r-4' : 'text-gray-700 hover:bg-gray-50 hover:text-gray-900'"
          :style="currentTab === 'settings' ? 'background-color: #035d73; border-color: #035d73' : ''"
        >
          <svg
            class="mr-3 h-5 w-5 transition-colors duration-200 flex-shrink-0"
            :class="currentTab === 'settings' ? 'text-white' : 'text-gray-400 group-hover:text-gray-600'"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"
            />
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"
            />
          </svg>
          <span class="truncate">Configurações</span>
        </button>
      </div>
    </nav>

    <!-- User Profile & Actions - Fixed at Bottom -->
    <div class="p-6 border-t border-gray-200 bg-gray-50 flex-shrink-0">
      <!-- Notifications Button -->
      <button
        @click="currentTab = 'notifications'; sidebarOpen = false"
        class="w-full flex items-center px-4 py-3 text-sm font-medium text-left rounded-lg transition-all duration-200 cursor-pointer group mb-3"
        :class="currentTab === 'notifications' ? 'text-white' : 'text-gray-700 hover:bg-gray-200 hover:text-gray-900'"
        :style="currentTab === 'notifications' ? 'background-color: #035d73' : ''"
      >
        <svg
          class="mr-3 h-5 w-5 transition-colors duration-200 flex-shrink-0"
          :class="currentTab === 'notifications' ? 'text-white' : 'text-gray-400 group-hover:text-gray-600'"
          fill="none"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M10 2a6 6 0 00-6 6c0 1.887-.454 3.665-1.257 5.234a.75.75 0 00.515 1.076 32.91 32.91 0 003.256.508 3.5 3.5 0 006.972 0 32.91 32.91 0 003.256-.508.75.75 0 00.515-1.076A11.448 11.448 0 0116 8a6 6 0 00-6-6zM8.05 14.943a33.54 33.54 0 003.9 0 2 2 0 01-3.9 0z"
          />
        </svg>
        <span class="truncate">Notificações</span>
        <span
          x-show="dashboardData.notificationsCount > 0"
          class="ml-auto bg-red-100 text-red-800 text-xs font-medium px-2 py-1 rounded-full flex-shrink-0"
          x-text="dashboardData.notificationsCount"
        ></span>
      </button>

      <!-- User Profile -->
      <div class="relative">
        <button
          @click="userDropdownOpen = !userDropdownOpen"
          class="w-full flex items-center p-3 rounded-lg hover:bg-gray-100 transition-colors duration-200 cursor-pointer"
        >
          <img
            class="h-10 w-10 rounded-full object-cover flex-shrink-0"
            :src="user.avatar"
            :alt="user.name"
            @error="$event.target.src='{% static "zela-workers-new-photos/madalena-rodrigues-1.jpeg" %}'"
          />
          <div class="ml-3 flex-1 text-left min-w-0">
            <p class="text-sm font-semibold truncate" style="color: #011e41" x-text="user.name"></p>
            <p class="text-xs text-gray-500 truncate" x-text="user.email"></p>
          </div>
          <svg
            class="ml-2 h-5 w-5 text-gray-400 transition-transform duration-200 flex-shrink-0"
            :class="userDropdownOpen ? 'rotate-180' : 'rotate-0'"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M19 9l-7 7-7-7"
            />
          </svg>
        </button>

        <!-- User Dropdown Menu -->
        <div
          x-show="userDropdownOpen"
          @click.away="userDropdownOpen = false"
          x-transition:enter="transition ease-out duration-200"
          x-transition:enter-start="opacity-0 transform scale-95"
          x-transition:enter-end="opacity-100 transform scale-100"
          x-transition:leave="transition ease-in duration-150"
          x-transition:leave-start="opacity-100 transform scale-100"
          x-transition:leave-end="opacity-0 transform scale-95"
          class="absolute bottom-full left-0 w-full mb-2 bg-white rounded-lg shadow-lg border border-gray-200 z-50"
        >
          <div class="py-1">
            <button
              @click="currentTab = 'profile'; userDropdownOpen = false; sidebarOpen = false"
              class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer"
            >
              Configurações do Perfil
            </button>
            <button
              @click="currentTab = 'settings'; userDropdownOpen = false; sidebarOpen = false"
              class="w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 cursor-pointer"
            >
              Configurações da Conta
            </button>
            <div class="border-t border-gray-200"></div>
            <button
              @click="window.location.href='{% url 'website:sign-out' %}'"
              class="w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-gray-100 cursor-pointer"
            >
              Sair
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Main Content Area -->
  <div class="flex-1 flex flex-col min-w-0 h-screen lg:ml-0">
    <!-- Top Header with Breadcrumbs - Match sidebar logo height -->
    <header class="bg-white shadow-sm border-b border-gray-200 px-4 sm:px-6 lg:px-8 flex-shrink-0" style="height: 80px;">
      <div class="flex justify-between items-center h-full">
        <div class="flex items-center flex-1">
          <!-- Mobile menu button -->
          <button
            @click="sidebarOpen = true"
            class="lg:hidden p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 mr-3 cursor-pointer"
          >
            <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
            </svg>
          </button>
          
          <!-- Breadcrumbs -->
          <nav class="flex" aria-label="Breadcrumb">
            <ol class="flex items-center space-x-2 text-sm">
              <li>
                <span class="text-gray-500">Painel</span>
              </li>
              <li>
                <svg class="h-4 w-4 text-gray-400 mx-2" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 111.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd" />
                </svg>
              </li>
              <li>
                <span x-show="!isProviderMode" class="text-gray-500">Cliente</span>
                <span x-show="isProviderMode" class="text-gray-500">Prestador</span>
              </li>
              <li>
                <svg class="h-4 w-4 text-gray-400 mx-2" fill="currentColor" viewBox="0 0 20 20">
                  <path fill-rule="evenodd" d="M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 111.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z" clip-rule="evenodd" />
                </svg>
              </li>
              <li>
                <span class="font-medium" style="color: #011e41" x-text="getTabDisplayName()"></span>
              </li>
            </ol>
          </nav>
        </div>
        
      </div>
    </header>

    <!-- Tab Content - Scrollable with proper container -->
    <main class="flex-1 overflow-y-auto bg-gray-50">
      <div class="p-4 sm:p-6 lg:p-8 max-w-7xl mx-auto">
      <!-- Tab Contents -->
      {% include 'website/components/dashboard/tabs/overview.html' %}
      {% include 'website/components/dashboard/tabs/bookings.html' %}
      {% include 'website/components/dashboard/tabs/addresses.html' %}
      {% include 'website/components/dashboard/tabs/wallet.html' %}
      {% include 'website/components/dashboard/tabs/notifications.html' %}
      {% include 'website/components/dashboard/tabs/profile.html' %}
      {% include 'website/components/dashboard/tabs/help.html' %}

      <!-- Provider Tabs -->
      {% include 'website/components/dashboard/tabs/pro-overview.html' %}
      {% include 'website/components/dashboard/tabs/earnings.html' %}
      {% include 'website/components/dashboard/tabs/job-queue.html' %}
      {% include 'website/components/dashboard/tabs/availability.html' %}
      {% include 'website/components/dashboard/tabs/ratings.html' %}
      {% include 'website/components/dashboard/tabs/resources.html' %}
      {% include 'website/components/dashboard/tabs/kyc.html' %}
      {% include 'website/components/dashboard/tabs/settings.html' %}
      {% include 'website/components/dashboard/tabs/service-area.html' %}

      </div>
    </main>
  </div>
  
  <!-- Booking Success Modal -->
  <div 
    x-show="showBookingSuccessModal"
    x-transition:enter="transition ease-out duration-300"
    x-transition:enter-start="opacity-0"
    x-transition:enter-end="opacity-100"
    x-transition:leave="transition ease-in duration-200"
    x-transition:leave-start="opacity-100"
    x-transition:leave-end="opacity-0"
    class="fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50"
    @keydown.escape="showBookingSuccessModal = false"
  >
    <div 
      class="bg-white rounded-2xl shadow-xl max-w-md w-full overflow-hidden"
      @click.away="showBookingSuccessModal = false"
      x-transition:enter="transition ease-out duration-300"
      x-transition:enter-start="opacity-0 transform scale-90"
      x-transition:enter-end="opacity-100 transform scale-100"
      x-transition:leave="transition ease-in duration-200"
      x-transition:leave-start="opacity-100 transform scale-100"
      x-transition:leave-end="opacity-0 transform scale-90"
    >
      <!-- Modal Content with Improved Readability -->
      <div class="relative">
        <!-- Success Section -->
        <div class="text-center px-8 py-12">
          <!-- Success Icon -->
          <div class="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-8">
            <svg class="w-10 h-10 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7" />
            </svg>
          </div>
          
          <!-- Success Message -->
          <h2 class="text-2xl font-bold mb-4 text-gray-900">
            Reserva Criada com Sucesso!
          </h2>
          
          <!-- Description -->
          <p class="text-gray-600 text-base leading-relaxed max-w-sm mx-auto mb-8">
            O seu serviço de limpeza foi reservado.
            <br>
            Receberá um e-mail de confirmação com todos os detalhes.
          </p>
        </div>

        <!-- Next Steps Section -->
        <div class="px-8 pb-8">
          <div class="bg-gray-50 rounded-2xl p-6">
            <h3 class="text-lg font-semibold text-gray-800 mb-4 text-center">
              O que acontece a seguir?
            </h3>
            
            <div class="space-y-3">
              <!-- Email Step -->
              <div class="flex items-center">
                <div class="w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center mr-3 flex-shrink-0">
                  <span class="text-sm">📧</span>
                </div>
                <div>
                  <p class="text-gray-800 font-medium text-sm">Verifique o seu e-mail</p>
                  <p class="text-gray-600 text-xs">Confirmação da reserva enviada</p>
                </div>
              </div>
              
              <!-- Notification Step -->
              <div class="flex items-center">
                <div class="w-8 h-8 bg-yellow-100 rounded-full flex items-center justify-center mr-3 flex-shrink-0">
                  <span class="text-sm">🔔</span>
                </div>
                <div>
                  <p class="text-gray-800 font-medium text-sm">Notificações em tempo real</p>
                  <p class="text-gray-600 text-xs">Avisamos quando o prestador estiver a caminho</p>
                </div>
              </div>
              
              <!-- Chat Step -->
              <div class="flex items-center">
                <div class="w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center mr-3 flex-shrink-0">
                  <span class="text-sm">💬</span>
                </div>
                <div>
                  <p class="text-gray-800 font-medium text-sm">Chat com o prestador</p>
                  <p class="text-gray-600 text-xs">Comunique através da aplicação</p>
                </div>
              </div>
            </div>
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="px-8 pb-8">
          <div class="space-y-3">
            <button
              @click="showBookingSuccessModal = false; currentTab = 'bookings'"
              class="w-full py-4 px-6 bg-[#015e73] text-white font-semibold rounded-full hover:bg-[#014a5a] transition-colors duration-200 cursor-pointer"
            >
              Ver as Minhas Reservas
            </button>
            
            <button
              @click="window.location.href = '/book/'"
              class="w-full py-3 px-6 border-2 border-gray-300 text-gray-700 font-medium rounded-full hover:bg-gray-50 hover:border-gray-400 transition-all duration-200 cursor-pointer"
            >
              Fazer Outra Reserva
            </button>
          </div>
        </div>

      </div>
    </div>
  </div>
</div>
{% endblock %}
