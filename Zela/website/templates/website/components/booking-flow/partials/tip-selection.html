{% load static %}
<!-- Enhanced Tip Selection Component -->
<div class="bg-white border border-gray-200 rounded-2xl p-6 mb-8">
  <!-- Tip Header with Worker Info -->
  <div class="bg-gradient-to-r from-gray-900 to-gray-800 text-white rounded-2xl p-6 mb-6 relative overflow-hidden">
    <!-- Background Pattern -->
    <div class="absolute inset-0 opacity-10">
      <svg class="w-full h-full" viewBox="0 0 100 100" preserveAspectRatio="none">
        <pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse">
          <path d="M 10 0 L 0 0 0 10" fill="none" stroke="white" stroke-width="0.5"/>
        </pattern>
        <rect width="100" height="100" fill="url(#grid)" />
      </svg>
    </div>
    
    <div class="relative flex items-center">
      <div class="w-20 h-20 bg-white rounded-full mr-4 overflow-hidden flex-shrink-0 ring-4 ring-white/20">
        <img
          src="{% static 'beatriz.webp' %}"
          alt="Worker"
          class="w-full h-full object-cover"
          x-show="booking.selectedWorker"
        />
      </div>
      <div>
        <div class="text-lg text-gray-300 mb-1">Show your appreciation for</div>
        <div class="text-2xl font-bold" x-text="booking.selectedWorkerName || 'Your Worker'"></div>
        <div class="text-sm text-gray-300 mt-1">Tips go 100% to the worker</div>
      </div>
    </div>
  </div>

  <!-- Tip Amount Selection -->
  <div class="mb-6">
    <h4 class="text-lg font-bold mb-4" style="color: #011e41">
      Select tip amount
    </h4>
    
    <!-- Tip Options Grid -->
    <div class="grid grid-cols-3 gap-3 mb-4">
      <!-- No Tip -->
      <button
        @click="selectTip('no-tip', 0)"
        class="tip-option px-4 py-4 rounded-xl border-2 text-center transition-all"
        :class="booking.tip.selectedOption === 'no-tip' ? 'selected border-[#015e73] bg-[#015e73] text-white' : 'border-gray-200 hover:border-gray-300 bg-white'"
      >
        <span class="tip-emoji">ü§∑</span>
        <div class="tip-amount">R0</div>
        <div class="tip-label" :class="booking.tip.selectedOption === 'no-tip' ? 'text-white/80' : 'text-gray-500'">No tip</div>
      </button>

      <!-- Small Tip -->
      <button
        @click="selectTip('small', 25)"
        class="tip-option px-4 py-4 rounded-xl border-2 text-center transition-all"
        :class="booking.tip.selectedOption === 'small' ? 'selected border-[#015e73] bg-[#015e73] text-white' : 'border-gray-200 hover:border-gray-300 bg-white'"
      >
        <span class="tip-emoji">üòä</span>
        <div class="tip-amount">R25</div>
        <div class="tip-label" :class="booking.tip.selectedOption === 'small' ? 'text-white/80' : 'text-gray-500'">Nice work</div>
      </button>

      <!-- Medium Tip -->
      <button
        @click="selectTip('medium', 50)"
        class="tip-option px-4 py-4 rounded-xl border-2 text-center transition-all"
        :class="booking.tip.selectedOption === 'medium' ? 'selected border-[#015e73] bg-[#015e73] text-white' : 'border-gray-200 hover:border-gray-300 bg-white'"
      >
        <span class="tip-emoji">üòÉ</span>
        <div class="tip-amount">R50</div>
        <div class="tip-label" :class="booking.tip.selectedOption === 'medium' ? 'text-white/80' : 'text-gray-500'">Great job</div>
      </button>

      <!-- Large Tip -->
      <button
        @click="selectTip('large', 75)"
        class="tip-option px-4 py-4 rounded-xl border-2 text-center transition-all"
        :class="booking.tip.selectedOption === 'large' ? 'selected border-[#015e73] bg-[#015e73] text-white' : 'border-gray-200 hover:border-gray-300 bg-white'"
      >
        <span class="tip-emoji">ü§©</span>
        <div class="tip-amount">R75</div>
        <div class="tip-label" :class="booking.tip.selectedOption === 'large' ? 'text-white/80' : 'text-gray-500'">Excellent!</div>
      </button>

      <!-- Generous Tip -->
      <button
        @click="selectTip('generous', 100)"
        class="tip-option px-4 py-4 rounded-xl border-2 text-center transition-all"
        :class="booking.tip.selectedOption === 'generous' ? 'selected border-[#015e73] bg-[#015e73] text-white' : 'border-gray-200 hover:border-gray-300 bg-white'"
      >
        <span class="tip-emoji">üíñ</span>
        <div class="tip-amount">R100</div>
        <div class="tip-label" :class="booking.tip.selectedOption === 'generous' ? 'text-white/80' : 'text-gray-500'">Amazing!</div>
      </button>

      <!-- Custom Amount -->
      <div class="relative">
        <button
          @click="showCustomTipInput = true; selectTip('custom', booking.tip.amount)"
          class="tip-option px-4 py-4 rounded-xl border-2 text-center transition-all w-full h-full"
          :class="booking.tip.selectedOption === 'custom' ? 'selected border-[#015e73] bg-[#015e73] text-white' : 'border-gray-200 hover:border-gray-300 bg-white'"
        >
          <span class="tip-emoji">‚úèÔ∏è</span>
          <div class="tip-amount" x-show="booking.tip.selectedOption !== 'custom'">Custom</div>
          <div class="tip-amount" x-show="booking.tip.selectedOption === 'custom'" x-text="'R' + booking.tip.amount"></div>
          <div class="tip-label" :class="booking.tip.selectedOption === 'custom' ? 'text-white/80' : 'text-gray-500'">Your choice</div>
        </button>
      </div>
    </div>

    <!-- Custom Tip Input -->
    <div x-show="showCustomTipInput" x-transition class="mt-4">
      <div class="flex items-center gap-3">
        <div class="relative flex-1">
          <span class="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500 font-medium">R</span>
          <input
            type="number"
            x-model="booking.tip.amount"
            @input="if($event.target.value) { selectTip('custom', parseInt($event.target.value)) }"
            placeholder="Enter amount"
            class="custom-tip-input w-full pl-8 pr-4 py-3 rounded-lg focus:outline-none"
            min="0"
            step="5"
          />
        </div>
        <button
          @click="showCustomTipInput = false"
          class="px-4 py-3 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors"
        >
          Done
        </button>
      </div>
    </div>

    <!-- Tip Impact Message -->
    <div class="tip-impact" x-show="booking.tip.amount > 0">
      <span class="tip-impact-icon">üíö</span>
      <span class="tip-impact-text">
        <span x-show="booking.tip.amount >= 100">Wow! Your generosity will make someone's day!</span>
        <span x-show="booking.tip.amount >= 75 && booking.tip.amount < 100">Your kindness makes a real difference!</span>
        <span x-show="booking.tip.amount >= 50 && booking.tip.amount < 75">Thank you for appreciating great service!</span>
        <span x-show="booking.tip.amount >= 25 && booking.tip.amount < 50">Every tip helps support our hardworking team!</span>
        <span x-show="booking.tip.amount > 0 && booking.tip.amount < 25">Thank you for showing your appreciation!</span>
      </span>
    </div>
  </div>

  <!-- Tip Benefits Info -->
  <div class="bg-gray-50 rounded-xl p-4 text-sm">
    <div class="flex items-start gap-3">
      <svg class="w-5 h-5 text-[#015e73] mt-0.5 flex-shrink-0" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
      </svg>
      <div class="text-gray-600">
        <p class="font-medium text-gray-800 mb-1">Why tip?</p>
        <ul class="space-y-1">
          <li>‚Ä¢ Tips are paid directly to your worker</li>
          <li>‚Ä¢ Show appreciation for excellent service</li>
          <li>‚Ä¢ Help support local service providers</li>
        </ul>
      </div>
    </div>
  </div>
</div>

<!-- Add the CSS -->
<link rel="stylesheet" href="{% static 'website/css/tip-styles.css' %}">

<!-- Initialize component data -->
<script>
  // Add to Alpine component data
  if (!window.showCustomTipInput) {
    window.showCustomTipInput = false;
  }
</script>