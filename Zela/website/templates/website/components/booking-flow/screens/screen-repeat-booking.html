{% load static %}

<!-- Screen: Repeat Booking Details -->
<div class="min-h-screen bg-white flex flex-col">
  <!-- Progress Header -->
  {% include "website/components/booking-flow/partials/booking-progress-header.html" %}

  <!-- Main Content with Sticky Sidebar -->
  <div class="flex flex-1 max-w-7xl mx-auto w-full">
    <!-- Sticky Left Column - Booking Details -->
    <div
      class="w-80 flex-shrink-0 sticky top-0 h-screen overflow-y-auto px-6 py-8 space-y-6"
    >
      <!-- Booking Details -->
      <div class="bg-white border border-gray-200 rounded-2xl p-6">
        <h3 class="text-lg font-bold mb-4" style="color: #011e41">
          Detalhes da Reserva
        </h3>

        <!-- Pricing Display -->
        <div class="bg-gray-900 text-white rounded-2xl p-4">
          <div class="flex justify-between items-center mb-2">
            <div class="flex flex-col">
              <div class="text-2xl font-bold" data-sessions>4</div>
              <div class="text-sm text-gray-300">sess√µes</div>
            </div>
            <div class="flex flex-col text-right">
              <div class="text-2xl font-bold" data-total-cost>R2840</div>
              <div class="text-sm text-gray-300">total</div>
            </div>
          </div>
          <div class="flex justify-between text-sm text-gray-300">
            <div data-duration>5.5 hrs each</div>
            <div>Melhor Valor</div>
          </div>
        </div>

        <!-- Savings Badge -->
        <div class="mt-4 bg-[#FDEA00] text-gray-900 rounded-lg p-3 text-center">
          <div class="font-bold text-sm">
            <span x-show="booking.repeat.numberOfSessions >= 8">Poupe 25%</span>
            <span
              x-show="booking.repeat.numberOfSessions >= 4 && booking.repeat.numberOfSessions < 8"
              >Poupe 15%</span
            >
            <span x-show="booking.repeat.numberOfSessions < 4"
              >Reserve mais para poupar!</span
            >
          </div>
        </div>
      </div>

      <!-- Location & Service Details -->
      <div class="bg-white border border-gray-200 rounded-2xl p-6">
        <!-- Location -->
        <div class="flex items-center justify-between mb-4">
          <div>
            <div class="text-sm text-gray-600 mb-1">Onde:</div>
            <div class="text-sm font-medium" style="color: #011e41">
              1 Osborne Rd, Mowbray, Cape To...
            </div>
          </div>
          <button class="text-gray-400 hover:text-gray-600 cursor-pointer">
            <svg
              class="w-4 h-4"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"
              />
            </svg>
          </button>
        </div>

        <!-- Service Type -->
        <div class="flex items-center justify-between">
          <div>
            <div class="text-sm text-gray-600 mb-1">O qu√™:</div>
            <div class="text-sm font-medium" style="color: #011e41">
              Limpeza Interior
            </div>
          </div>
          <button class="text-gray-400 hover:text-gray-600 cursor-pointer">
            <svg
              class="w-4 h-4"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"
              />
            </svg>
          </button>
        </div>
      </div>

      <!-- Repeat Benefits -->
      <div class="bg-white border border-gray-200 rounded-2xl p-6 text-center">
        <div
          class="w-20 h-20 bg-gradient-to-br from-green-100 to-blue-100 rounded-full mx-auto mb-3 flex items-center justify-center"
        >
          <div class="text-2xl">üîÑ</div>
        </div>
        <div class="text-sm font-bold mb-2" style="color: #011e41">
          Benef√≠cios da Reserva Recorrente
        </div>
        <div class="text-xs text-gray-600 space-y-1">
          <div>‚Ä¢ Qualidade de servi√ßo consistente</div>
          <div>‚Ä¢ Descontos por volume</div>
          <div>‚Ä¢ Reserva priorit√°ria</div>
          <div>‚Ä¢ Mesmo trabalhador de confian√ßa</div>
        </div>
      </div>
    </div>

    <!-- Scrollable Right Column - Repeat Booking Form -->
    <div class="flex-1 overflow-y-auto px-6 py-8">
      <div class="max-w-2xl">
        <h2 class="text-3xl font-bold mb-2" style="color: #011e41">
          Reserva Recorrente
        </h2>
        <p class="text-gray-600 mb-8">
          Poupe dinheiro com servi√ßo regular. Defina o seu hor√°rio e desfrute de
          consist√™ncia.
        </p>

        <!-- Form Fields -->
        <div class="space-y-6">
          <!-- Repeat Frequency -->
          <div>
            <h3 class="text-lg font-bold mb-4" style="color: #011e41">
              Com que frequ√™ncia precisa do servi√ßo?
            </h3>
            <div class="grid grid-cols-2 gap-4">
              <div
                onclick="setRepeatFrequency('weekly')"
                class="bg-white border-2 border-gray-200 rounded-xl p-4 cursor-pointer hover:border-[#015e73] transition-colors duration-200 text-center"
                id="frequency-weekly"
              >
                <div class="text-lg font-bold mb-2" style="color: #011e41">
                  Semanal
                </div>
                <div class="text-sm text-gray-600">Todas as semanas</div>
                <div class="mt-2 hidden" id="frequency-weekly-indicator">
                  <div class="w-2 h-2 bg-[#015e73] rounded-full mx-auto"></div>
                </div>
              </div>
              <div
                onclick="setRepeatFrequency('bi-weekly')"
                class="bg-white border-2 border-gray-200 rounded-xl p-4 cursor-pointer hover:border-[#015e73] transition-colors duration-200 text-center"
                id="frequency-bi-weekly"
              >
                <div class="text-lg font-bold mb-2" style="color: #011e41">
                  Quinzenal
                </div>
                <div class="text-sm text-gray-600">A cada 2 semanas</div>
                <div class="mt-2 hidden" id="frequency-bi-weekly-indicator">
                  <div class="w-2 h-2 bg-[#015e73] rounded-full mx-auto"></div>
                </div>
              </div>
              <div
                onclick="setRepeatFrequency('monthly')"
                class="bg-white border-2 border-gray-200 rounded-xl p-4 cursor-pointer hover:border-[#015e73] transition-colors duration-200 text-center"
                id="frequency-monthly"
              >
                <div class="text-lg font-bold mb-2" style="color: #011e41">
                  Mensal
                </div>
                <div class="text-sm text-gray-600">Todos os meses</div>
                <div class="mt-2 hidden" id="frequency-monthly-indicator">
                  <div class="w-2 h-2 bg-[#015e73] rounded-full mx-auto"></div>
                </div>
              </div>
              <div
                onclick="setRepeatFrequency('custom')"
                class="bg-white border-2 border-gray-200 rounded-xl p-4 cursor-pointer hover:border-[#015e73] transition-colors duration-200 text-center"
                id="frequency-custom"
              >
                <div class="text-lg font-bold mb-2" style="color: #011e41">
                  Personalizado
                </div>
                <div class="text-sm text-gray-600">Defina o seu pr√≥prio</div>
                <div class="mt-2 hidden" id="frequency-custom-indicator">
                  <div class="w-2 h-2 bg-[#015e73] rounded-full mx-auto"></div>
                </div>
              </div>
            </div>
          </div>

          <!-- Days of Week (for weekly/bi-weekly) -->
          <div data-days-section style="display: none">
            <h4 class="text-lg font-bold mb-4" style="color: #011e41">
              Quais dias?
            </h4>
            <div class="grid grid-cols-7 gap-2">
              <div
                onclick="toggleDayOfWeek('monday')"
                class="bg-white border-2 border-gray-200 rounded-lg p-3 cursor-pointer hover:border-[#015e73] transition-colors duration-200 text-center"
                id="day-monday"
              >
                <div class="text-sm font-medium">Seg</div>
              </div>
              <div
                onclick="toggleDayOfWeek('tuesday')"
                class="bg-white border-2 border-gray-200 rounded-lg p-3 cursor-pointer hover:border-[#015e73] transition-colors duration-200 text-center"
                id="day-tuesday"
              >
                <div class="text-sm font-medium">Ter</div>
              </div>
              <div
                onclick="toggleDayOfWeek('wednesday')"
                class="bg-white border-2 border-gray-200 rounded-lg p-3 cursor-pointer hover:border-[#015e73] transition-colors duration-200 text-center"
                id="day-wednesday"
              >
                <div class="text-sm font-medium">Qua</div>
              </div>
              <div
                onclick="toggleDayOfWeek('thursday')"
                class="bg-white border-2 border-gray-200 rounded-lg p-3 cursor-pointer hover:border-[#015e73] transition-colors duration-200 text-center"
                id="day-thursday"
              >
                <div class="text-sm font-medium">Qui</div>
              </div>
              <div
                onclick="toggleDayOfWeek('friday')"
                class="bg-white border-2 border-gray-200 rounded-lg p-3 cursor-pointer hover:border-[#015e73] transition-colors duration-200 text-center"
                id="day-friday"
              >
                <div class="text-sm font-medium">Sex</div>
              </div>
              <div
                onclick="toggleDayOfWeek('saturday')"
                class="bg-white border-2 border-gray-200 rounded-lg p-3 cursor-pointer hover:border-[#015e73] transition-colors duration-200 text-center"
                id="day-saturday"
              >
                <div class="text-sm font-medium">S√°b</div>
              </div>
              <div
                onclick="toggleDayOfWeek('sunday')"
                class="bg-white border-2 border-gray-200 rounded-lg p-3 cursor-pointer hover:border-[#015e73] transition-colors duration-200 text-center"
                id="day-sunday"
              >
                <div class="text-sm font-medium">Dom</div>
              </div>
            </div>
            <div
              class="mt-2 text-sm text-gray-600 text-center"
              id="days-counter"
            >
              <span class="text-gray-500">
                Selecione os dias que deseja o servi√ßo
              </span>
            </div>
          </div>

          <!-- Number of Sessions -->
          <div>
            <h4 class="text-lg font-bold mb-4" style="color: #011e41">
              Quantas sess√µes?
            </h4>
            <div class="flex items-center space-x-4">
              <button
                onclick="decreaseNumberOfSessions()"
                class="w-12 h-12 bg-gray-200 rounded-full flex items-center justify-center hover:bg-gray-300 cursor-pointer transition-colors"
                id="sessions-decrease-btn"
              >
                <svg
                  class="w-5 h-5"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M20 12H4"
                  />
                </svg>
              </button>
              <input
                type="number"
                id="sessions-input"
                onchange="handleSessionsInputChange(this.value)"
                class="text-2xl font-bold min-w-[80px] text-center bg-white border border-gray-300 rounded-lg px-2 py-1 focus:ring-2 focus:ring-[#015e73] focus:border-transparent"
                min="1"
                max="52"
                value="4"
              />
              <button
                onclick="increaseNumberOfSessions()"
                class="w-12 h-12 bg-gray-200 rounded-full flex items-center justify-center hover:bg-gray-300 cursor-pointer transition-colors"
                id="sessions-increase-btn"
              >
                <svg
                  class="w-5 h-5"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M12 6v12m6-6H6"
                  />
                </svg>
              </button>
            </div>
            <div
              class="mt-2 text-sm text-gray-600 text-center"
              id="sessions-savings"
            >
              <span class="text-green-600 font-medium">
                üí∞ Poupe 15% em 4+ sess√µes!
              </span>
            </div>
          </div>

          <!-- Start Date -->
          <div>
            <h4 class="text-lg font-bold mb-4" style="color: #011e41">
              Quando deseja come√ßar?
            </h4>
            <input
              type="date"
              x-model="booking.repeat.startDate"
              class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#015e73] focus:border-transparent"
              :min="new Date().toISOString().split('T')[0]"
            />
          </div>

          <!-- Home Size -->
          <div>
            <h4 class="text-lg font-bold mb-4" style="color: #011e41">
              Qual √© o tamanho da sua casa?
            </h4>
            <select
              id="home-size-select"
              onchange="updateHomeSizeDuration()"
              class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#015e73] focus:border-transparent cursor-pointer"
            >
              <option value="small-1-2-bedrooms">
                Casa Pequena: 1-2 Quartos
              </option>
              <option value="medium-3-4-bedrooms" selected>
                Casa M√©dia: 3-4 Quartos
              </option>
              <option value="large-5-plus-bedrooms">
                Casa Grande: 5+ Quartos
              </option>
            </select>
          </div>

          <!-- Duration -->
          <div>
            <h4 class="text-lg font-bold mb-4" style="color: #011e41">
              Dura√ß√£o da Sess√£o
            </h4>
            <div class="flex items-center space-x-4">
              <button
                onclick="updateDuration(-0.5)"
                class="w-12 h-12 bg-gray-200 rounded-full flex items-center justify-center hover:bg-gray-300 cursor-pointer transition-colors"
              >
                <svg
                  class="w-5 h-5"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M20 12H4"
                  />
                </svg>
              </button>
              <div
                class="text-2xl font-bold min-w-[80px] text-center"
                id="duration-display"
              >
                5.5 hrs
              </div>
              <button
                onclick="updateDuration(0.5)"
                class="w-12 h-12 bg-gray-200 rounded-full flex items-center justify-center hover:bg-gray-300 cursor-pointer transition-colors"
              >
                <svg
                  class="w-5 h-5"
                  fill="none"
                  stroke="currentColor"
                  viewBox="0 0 24 24"
                >
                  <path
                    stroke-linecap="round"
                    stroke-linejoin="round"
                    stroke-width="2"
                    d="M12 6v12m6-6H6"
                  />
                </svg>
              </button>
            </div>
          </div>

          <!-- Start Time -->
          <div>
            <h4 class="text-lg font-bold mb-4" style="color: #011e41">
              Hora de in√≠cio preferida:
            </h4>
            <select
              id="start-time-select"
              class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#015e73] focus:border-transparent cursor-pointer"
            >
              <option value="07:00 - 07:30">07:00 - 07:30</option>
              <option value="07:30 - 08:00">07:30 - 08:00</option>
              <option value="08:00 - 08:30">08:00 - 08:30</option>
              <option value="08:30 - 09:00">08:30 - 09:00</option>
              <option value="09:00 - 09:30">09:00 - 09:30</option>
              <option value="09:30 - 10:00">09:30 - 10:00</option>
              <option value="10:00 - 10:30">10:00 - 10:30</option>
              <option value="10:30 - 11:00">10:30 - 11:00</option>
              <option value="11:00 - 11:30">11:00 - 11:30</option>
              <option value="11:30 - 12:00">11:30 - 12:00</option>
              <option value="12:00 - 12:30">12:00 - 12:30</option>
              <option value="12:30 - 13:00">12:30 - 13:00</option>
              <option value="13:00 - 13:30">13:00 - 13:30</option>
              <option value="13:30 - 14:00">13:30 - 14:00</option>
              <option value="14:00 - 14:30">14:00 - 14:30</option>
              <option value="14:30 - 15:00">14:30 - 15:00</option>
            </select>
          </div>

          <!-- Special Instructions -->
          <div>
            <h4 class="text-lg font-bold mb-4" style="color: #011e41">
              Instru√ß√µes especiais para o seu trabalhador
            </h4>
            <textarea
              id="special-instructions"
              placeholder="Adicione quaisquer instru√ß√µes especiais ou prefer√™ncias para o seu servi√ßo recorrente..."
              class="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#015e73] focus:border-transparent h-24 resize-none"
            ></textarea>
          </div>

          <!-- Action Buttons -->
          <div class="flex space-x-4 pt-6">
            <button
              onclick="findWorker()"
              class="flex-1 min-h-[44px] py-2.5 sm:py-3 px-3 sm:px-4 lg:px-6 bg-[#015e73] text-white font-semibold rounded-full hover:bg-[#014a5a] transition-colors duration-200 cursor-pointer text-sm sm:text-base"
            >
              Encontrar um Trabalhador
            </button>
            <button
              onclick="goToScreen(2)"
              class="flex-1 min-h-[44px] py-2.5 sm:py-3 px-3 sm:px-4 lg:px-6 bg-white border border-gray-300 text-gray-700 font-semibold rounded-full hover:bg-gray-50 transition-colors duration-200 cursor-pointer text-sm sm:text-base"
            >
              Voltar
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
