{% load static %}
<!-- Screen 15: Booking Confirmation -->
<div class="min-h-screen bg-white flex items-center justify-center">
  <div class="max-w-md w-full mx-auto px-6 py-8 text-center">
    <!-- Success Icon -->
    <div class="mb-8">
      <div
        class="w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4"
      >
        <svg
          class="w-10 h-10 text-green-600"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M5 13l4 4L19 7"
          />
        </svg>
      </div>



    <!-- Congratulations Message -->
    <div class="mb-8">
      <h1 class="text-3xl font-bold mb-4" style="color: #011e41">
        Parab√©ns! üéâ
      </h1>
      <p class="text-lg text-gray-600 mb-2">A sua reserva foi confirmada</p>
      <p class="text-sm text-gray-500">
        Receber√° um email de confirma√ß√£o em breve com todos os detalhes.
      </p>
    </div>

    <!-- Booking Details Summary -->
    <div class="bg-gray-50 rounded-2xl p-6 mb-8 text-left">
      <h3 class="text-lg font-bold mb-4" style="color: #011e41">
        Resumo da Reserva
      </h3>

      <div class="space-y-3">
        <div class="flex justify-between">
          <span class="text-gray-600">Servi√ßo:</span>
          <span class="font-medium" style="color: #011e41" id="service-name">
            Limpeza Interior
          </span>
        </div>

        <div class="flex justify-between">
          <span class="text-gray-600">Data e Hora:</span>
          <span class="font-medium" style="color: #011e41" id="date-time">
            A carregar...
          </span>
        </div>

        <div class="flex justify-between">
          <span class="text-gray-600">Localiza√ß√£o:</span>
          <span class="font-medium" style="color: #011e41" id="location">
            A carregar...
          </span>
        </div>

        <div class="flex justify-between">
          <span class="text-gray-600">Dura√ß√£o:</span>
          <span class="font-medium" style="color: #011e41" id="duration">
            A carregar...
          </span>
        </div>

        <div class="border-t pt-3">
          <div class="flex justify-between">
            <span class="text-gray-600 font-medium">Total Pago:</span>
            <span class="font-bold text-lg" style="color: #011e41" id="total-paid">
              A carregar...
            </span>
          </div>
        </div>
      </div>
    </div>

    <!-- Next Steps -->
    <div class="bg-blue-50 rounded-2xl p-6 mb-8">
      <h4 class="text-lg font-bold mb-3" style="color: #011e41">
        O que vem a seguir?
      </h4>
      <div class="space-y-2 text-sm text-gray-700">
        <div class="flex items-start">
          <span class="text-blue-600 mr-2">üìß</span>
          <span>Verifique o seu email para confirma√ß√£o da reserva</span>
        </div>
        <div class="flex items-start">
          <span class="text-blue-600 mr-2">üì±</span>
          <span>Acompanhe a sua reserva no painel</span>
        </div>
        <div class="flex items-start">
          <span class="text-blue-600 mr-2">üè†</span>
          <span>Prepare o seu espa√ßo para o servi√ßo de limpeza</span>
        </div>
      </div>
    </div>

    <!-- Action Button -->
    <button
      onclick="goToDashboard()"
      class="w-full py-4 px-6 bg-[#015e73] text-white font-semibold rounded-full hover:bg-[#014a5a] transition-colors duration-200 cursor-pointer text-lg"
    >
      OK
    </button>

    <!-- Additional Help -->
    <div class="mt-6">
      <p class="text-sm text-gray-500">
        Precisa de ajuda?
        <a href="/help-center/" class="text-[#015e73] hover:underline"
          >Visite o nosso Centro de Ajuda</a
        >
      </p>
    </div>
  </div>
</div>

<script>
  function goToDashboard() {
    // Navigate to dashboard
    window.location.href = "/dashboard/";
  }
  
  // Update booking summary with dynamic data
  document.addEventListener('DOMContentLoaded', function() {
    updateBookingSummary();
  });
  
  function updateBookingSummary() {
    if (window.bookingFlowComponent) {
      const booking = window.bookingFlowComponent.booking;
      
      // Update service name
      const serviceName = window.bookingFlowComponent.serviceInfo[booking.serviceType]?.name || 'Indoor Cleaning';
      document.getElementById('service-name').textContent = serviceName;
      
      // Update date and time
      if (booking.date) {
        const date = new Date(booking.date);
        const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
        const months = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
        
        const dateStr = `${days[date.getDay()]} ${date.getDate()} ${months[date.getMonth()]} @ ${booking.details.startTime || '07:00'}`;
        document.getElementById('date-time').textContent = dateStr;
      }
      
      // Update location
      const location = booking.location.streetAddress || 'Localiza√ß√£o n√£o definida';
      const truncatedLocation = location.length > 30 ? location.substring(0, 27) + '...' : location;
      document.getElementById('location').textContent = truncatedLocation;
      
      // Update duration
      document.getElementById('duration').textContent = `${booking.details.duration} horas`;
      
      // Update total paid (including tip)
      const totalWithTip = booking.pricing.total + booking.tip.amount;
      document.getElementById('total-paid').textContent = `AOA ${totalWithTip.toLocaleString('pt-AO', {minimumFractionDigits: 0, maximumFractionDigits: 0})}`;
    } else {
      // Fallback if component not available
      setTimeout(updateBookingSummary, 100);
    }
  }
</script>
