{% load static %}

<!-- Screen 3: AC Unit Configuration -->
<div class="min-h-screen bg-white flex flex-col">
  <!-- Progress Header -->
  {% include "website/components/booking-flow/partials/booking-progress-header.html" %}

  <!-- Main Content -->
  <div class="flex-1 max-w-5xl mx-auto w-full px-4 sm:px-6 py-6 sm:py-8 lg:py-12">
    <!-- Title Section with better hierarchy -->
    <div class="text-center mb-6 sm:mb-8 lg:mb-10">
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold mb-2 sm:mb-3" style="color: #011e41">
        Quantas unidades de ar condicionado precisa de reparar?
      </h2>
      <p class="text-sm sm:text-base lg:text-lg text-gray-600 max-w-2xl mx-auto">
        Oferecemos descontos por volume para mÃºltiplas unidades.
      </p>
    </div>

    <!-- Unit Count Selector -->
    <div
      class="bg-white border border-gray-200 rounded-2xl p-6 sm:p-8 lg:p-10 mb-6 sm:mb-8 shadow-sm hover:shadow-md transition-shadow duration-200"
    >
      <div class="flex items-center justify-center mb-8">
        <button
          @click="decrementUnitCount()"
          class="w-16 h-16 bg-gray-100 hover:bg-gray-200 rounded-full flex items-center justify-center transition-all duration-200 cursor-pointer hover:scale-110"
          :disabled="(booking.unitCount || 1) <= 1"
          :class="{ 'opacity-30 cursor-not-allowed hover:scale-100': (booking.unitCount || 1) <= 1 }"
        >
          <svg
            class="w-6 h-6"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M20 12H4"
            />
          </svg>
        </button>

        <div class="mx-12 text-center">
          <div class="relative inline-block">
            <div
              class="text-5xl sm:text-6xl lg:text-7xl font-bold mb-2 transition-all duration-200"
              style="color: #011e41"
              x-text="booking.unitCount || 1"
            ></div>
            <!-- Yellow accent behind number -->
            <div
              class="absolute inset-0 bg-[#f4d35e]/20 rounded-full blur-2xl -z-10 scale-150"
            ></div>
          </div>
          <div class="text-base text-gray-600 font-medium mt-2">
            <span
              x-text="(booking.unitCount || 1) === 1 ? 'Unidade' : 'Unidades'"
            ></span>
          </div>
        </div>

        <button
          @click="incrementUnitCount()"
          class="w-16 h-16 bg-[#f4d35e]/20 hover:bg-[#f4d35e]/30 border border-[#f4d35e] rounded-full flex items-center justify-center transition-all duration-200 cursor-pointer hover:scale-110"
        >
          <svg
            class="w-6 h-6"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M12 4v16m8-8H4"
            />
          </svg>
        </button>
      </div>

      <!-- Pricing Breakdown -->
      <div class="border-t-2 border-dashed border-gray-200 pt-8 mt-8">
        <h3 class="font-bold text-lg mb-4" style="color: #011e41">
          Detalhes do PreÃ§o:
        </h3>

        <div class="space-y-3">
          <!-- Base Price -->
          <div class="flex justify-between items-center">
            <span class="text-gray-600">PreÃ§o base por unidade:</span>
            <span class="font-medium" x-text="formatCurrency(16000)"></span>
          </div>

          <!-- Discount -->
          <div
            class="flex justify-between items-center bg-[#f4d35e]/10 px-4 py-2 rounded-lg"
            x-show="getACDiscount() > 0"
          >
            <span class="text-gray-700 font-medium">
              ðŸŽ‰ Desconto por volume (<span x-text="getACDiscount()"></span>%):
            </span>
            <span class="font-bold text-green-600">
              -<span x-text="formatCurrency(getACDiscountAmount())"></span>
            </span>
          </div>

          <!-- Total -->
          <div
            class="flex justify-between items-center pt-4 mt-4 border-t-2 border-gray-300"
          >
            <span class="font-bold text-xl" style="color: #011e41">Total:</span>
            <div class="text-right">
              <span
                class="text-3xl font-bold"
                style="color: #015e73"
                x-text="formatCurrency(getACTotalPrice())"
              ></span>
              <div
                class="text-xs text-gray-500 mt-1"
                x-show="getACDiscount() > 0"
              >
                VocÃª economiza
                <span x-text="formatCurrency(getACDiscountAmount())"></span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Discount Information -->
    <div
      class="bg-gradient-to-br from-[#f4d35e]/10 to-[#f4d35e]/5 border border-[#f4d35e]/50 rounded-2xl p-6 mb-8"
    >
      <h3 class="font-bold mb-4 flex items-center" style="color: #011e41">
        <span class="text-2xl mr-2">ðŸ’°</span>
        <span>Poupe com descontos por volume:</span>
      </h3>
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div
          class="flex items-center p-3 rounded-lg transition-all duration-200"
          :class="(booking.unitCount || 1) === 1 ? 'bg-white border border-[#f4d35e]' : 'hover:bg-white/50'"
        >
          <div
            class="w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mr-3"
          >
            <span class="font-bold text-gray-600">1</span>
          </div>
          <div>
            <span class="block font-medium text-gray-800">1 unidade</span>
            <span class="text-sm text-gray-600">PreÃ§o total</span>
          </div>
        </div>
        <div
          class="flex items-center p-3 rounded-lg transition-all duration-200"
          :class="(booking.unitCount || 1) >= 2 && (booking.unitCount || 1) <= 3 ? 'bg-white border border-[#f4d35e]' : 'hover:bg-white/50'"
        >
          <div
            class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mr-3"
          >
            <span class="font-bold text-green-600">2-3</span>
          </div>
          <div>
            <span class="block font-medium text-gray-800">2-3 unidades</span>
            <span class="text-sm font-semibold text-green-600"
              >10% desconto cada</span
            >
          </div>
        </div>
        <div
          class="flex items-center p-3 rounded-lg transition-all duration-200"
          :class="(booking.unitCount || 1) >= 4 && (booking.unitCount || 1) <= 5 ? 'bg-white border border-[#f4d35e]' : 'hover:bg-white/50'"
        >
          <div
            class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mr-3"
          >
            <span class="font-bold text-green-600">4-5</span>
          </div>
          <div>
            <span class="block font-medium text-gray-800">4-5 unidades</span>
            <span class="text-sm font-semibold text-green-600"
              >15% desconto cada</span
            >
          </div>
        </div>
        <div
          class="flex items-center p-3 rounded-lg transition-all duration-200"
          :class="(booking.unitCount || 1) >= 6 ? 'bg-white border border-[#f4d35e]' : 'hover:bg-white/50'"
        >
          <div
            class="w-12 h-12 bg-green-100 rounded-full flex items-center justify-center mr-3"
          >
            <span class="font-bold text-green-600">6+</span>
          </div>
          <div>
            <span class="block font-medium text-gray-800">6+ unidades</span>
            <span class="text-sm font-semibold text-green-600"
              >20% desconto cada</span
            >
          </div>
        </div>
      </div>
    </div>

    <!-- Service Notes -->
    <div class="mb-8">
      <label class="block text-sm font-medium mb-2" style="color: #4a5a70">
        InformaÃ§Ãµes adicionais (opcional)
      </label>
      <textarea
        x-model="booking.acServiceNotes"
        placeholder="Ex: Marcas das unidades, problemas especÃ­ficos, localizaÃ§Ã£o das unidades..."
        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#015e73] focus:border-transparent resize-none"
        rows="3"
      ></textarea>
    </div>

    <!-- Continue Button -->
    <div>
      <button
        @click="proceedFromACConfiguration()"
        class="w-full min-h-[44px] py-3 sm:py-4 lg:py-5 px-4 sm:px-6 lg:px-8 bg-gradient-to-r from-[#015e73] to-[#017891] text-white font-bold text-sm sm:text-base lg:text-lg rounded-2xl hover:from-[#014a5a] hover:to-[#015e73] transition-all duration-300 shadow-lg transform hover:scale-[1.01] flex items-center justify-center cursor-pointer"
      >
        <span>Continuar</span>
        <span class="mx-2">-</span>
        <span x-text="formatCurrency(getACTotalPrice())"></span>
        <svg
          class="w-5 h-5 ml-3"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M13 7l5 5m0 0l-5 5m5-5H6"
          />
        </svg>
      </button>
    </div>

    <!-- Back Button -->
    <div class="mt-6 text-center">
      <button
        @click="goToScreen(1)"
        class="inline-flex items-center text-gray-600 hover:text-[#015e73] font-medium transition-colors duration-200 group cursor-pointer"
      >
        <svg
          class="w-5 h-5 mr-2 transform group-hover:-translate-x-1 transition-transform"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M10 19l-7-7m0 0l7-7m-7 7h18"
          />
        </svg>
        <span>Voltar ao passo anterior</span>
      </button>
    </div>
  </div>
</div>
