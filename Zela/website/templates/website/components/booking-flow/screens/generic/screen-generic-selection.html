{% load static %}

<!-- Generic Selection Screen - Configurable for Multiple Services -->
<div class="min-h-screen bg-white flex flex-col" x-data="genericSelection()">
  <!-- Progress Header -->
  {% include "website/components/booking-flow/partials/booking-progress-header.html" %}

  <!-- Main Content -->
  <div class="flex-1 max-w-5xl mx-auto w-full px-4 sm:px-6 py-6 sm:py-8 lg:py-12">
    <!-- Title Section with better hierarchy -->
    <div class="text-center mb-6 sm:mb-8 lg:mb-10">
      <h2 class="text-2xl sm:text-3xl lg:text-4xl font-bold mb-2 sm:mb-3" style="color: #011e41" x-text="config.title">
        Selecione uma opção
      </h2>
      <p class="text-sm sm:text-base lg:text-lg text-gray-600 max-w-2xl mx-auto" x-text="config.description">
        Escolha a opção desejada
      </p>
    </div>

    <!-- Options Grid/List with improved spacing -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-4 sm:gap-6 mb-6 sm:mb-8">
      <template x-for="option in config.options" :key="option.id">
        <div
          @click="selectOption(option)"
          class="relative bg-white border rounded-2xl p-4 sm:p-6 cursor-pointer transition-all duration-200 transform hover:scale-[1.005]"
          :class="isSelected(option.id) ? 'bg-gradient-to-br from-[#f4d35e]/5 to-[#f4d35e]/10 border-[#f4d35e] ring-2 ring-[#f4d35e]/30' : 'border-gray-300 hover:border-gray-600'"
        >
          <!-- Selected Badge -->
          <div
            x-show="isSelected(option.id)"
            class="absolute -top-3 -right-3 bg-[#f4d35e] text-[#011e41] px-3 py-1 rounded-full text-xs font-semibold shadow-sm"
            x-transition
          >
            Selecionado
          </div>

          <div class="flex items-start justify-between">
            <div class="flex-1">
              <div class="flex items-center mb-3">
                <template x-if="!config.multiSelect">
                  <div
                    class="w-12 h-12 rounded-xl flex items-center justify-center mr-3"
                    :class="isSelected(option.id) ? 'bg-[#f4d35e]/20 ring-2 ring-[#f4d35e]/50' : 'bg-[#015e73]/10'"
                  >
                    <span
                      class="text-lg font-bold"
                      :class="isSelected(option.id) ? 'text-[#011e41]' : 'text-[#015e73]'"
                      x-text="option.icon || '✓'"
                    ></span>
                  </div>
                </template>
                <div>
                  <h3 class="text-lg sm:text-xl lg:text-2xl font-bold" style="color: #011e41" x-text="option.label"></h3>
                  <template x-if="option.description">
                    <p class="text-sm text-gray-500" x-text="option.description"></p>
                  </template>
                </div>
              </div>

              <template x-if="option.details && option.details.length > 0">
                <div class="space-y-2 mt-4">
                  <template x-for="detail in option.details" :key="detail">
                    <div class="flex items-center text-gray-600">
                      <svg class="w-4 h-4 mr-2 text-[#015e73]" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                      </svg>
                      <span class="text-sm" x-text="detail"></span>
                    </div>
                  </template>
                </div>
              </template>
            </div>

            <div class="ml-4">
              <!-- Checkbox for multi-select -->
              <template x-if="config.multiSelect">
                <div 
                  class="w-8 h-8 rounded-lg border-2 flex items-center justify-center transition-all duration-200 cursor-pointer"
                  :class="isSelected(option.id) ? 'bg-[#f4d35e] border-[#f4d35e]' : 'border-gray-300 bg-white'"
                >
                  <svg
                    x-show="isSelected(option.id)"
                    x-transition
                    class="w-4 h-4 text-[#011e41]"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"/>
                  </svg>
                </div>
              </template>
              <!-- Radio for single-select -->
              <template x-if="!config.multiSelect">
                <div 
                  class="w-8 h-8 rounded-full border-2 flex items-center justify-center transition-all duration-200 cursor-pointer"
                  :class="isSelected(option.id) ? 'bg-[#f4d35e] border-[#f4d35e]' : 'border-gray-300 bg-white'"
                >
                  <svg
                    x-show="isSelected(option.id)"
                    x-transition
                    class="w-4 h-4 text-[#011e41]"
                    fill="none"
                    stroke="currentColor"
                    viewBox="0 0 24 24"
                  >
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"/>
                  </svg>
                </div>
              </template>
            </div>
          </div>

          <!-- Price Section with better visibility -->
          <template x-if="option.price">
            <div
              class="pt-4 mt-4 border-t-2 border-dashed"
              :class="isSelected(option.id) ? 'border-[#f4d35e]/40' : 'border-gray-200'"
            >
              <div class="flex justify-between items-end">
                <div>
                  <div class="text-xs uppercase tracking-wider text-gray-500 mb-1">
                    Preço
                  </div>
                  <div class="text-lg sm:text-xl lg:text-2xl font-bold" style="color: #015e73">
                    AOA <span x-text="option.price.toLocaleString('pt-AO')"></span>
                  </div>
                </div>
                <template x-if="option.priceModifier">
                  <div class="text-xs text-gray-500" x-text="option.priceModifier"></div>
                </template>
              </div>
            </div>
          </template>
        </div>
      </template>
    </div>

    <!-- Action Section with improved CTA -->
    <div class="mt-6 sm:mt-8 lg:mt-10">
      <!-- Continue Button with animation -->
      <div
        x-show="hasValidSelection()"
        x-transition:enter="transition ease-out duration-300"
        x-transition:enter-start="opacity-0 transform translate-y-4"
        x-transition:enter-end="opacity-100 transform translate-y-0"
        class="relative"
      >
        <button
          @click="continueToNext()"
          class="w-full min-h-[44px] py-3 sm:py-4 lg:py-5 px-4 sm:px-6 lg:px-8 bg-gradient-to-r from-[#015e73] to-[#017891] text-white font-bold text-sm sm:text-base lg:text-lg rounded-2xl hover:from-[#014a5a] hover:to-[#015e73] transition-all duration-300 shadow-lg transform hover:scale-[1.01] flex items-center justify-center group cursor-pointer"
        >
          <span>Continuar</span>
          <svg
            class="w-5 h-5 ml-2 transform group-hover:translate-x-1 transition-transform"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/>
          </svg>
        </button>
      </div>

      <!-- Helper text when nothing selected -->
      <div
        x-show="!hasValidSelection()"
        class="text-center py-5 px-8 bg-gray-50 rounded-2xl border-2 border-dashed border-gray-300"
      >
        <svg
          class="w-12 h-12 mx-auto text-gray-400 mb-3"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path
            stroke-linecap="round"
            stroke-linejoin="round"
            stroke-width="2"
            d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"
          />
        </svg>
        <p class="text-gray-600 font-medium">
          <template x-if="config.multiSelect">
            <span>Selecione pelo menos uma opção para continuar</span>
          </template>
          <template x-if="!config.multiSelect">
            <span>Selecione uma opção para continuar</span>
          </template>
        </p>
        <p class="text-sm text-gray-500 mt-1">Clique em uma das opções acima</p>
      </div>
    </div>

    <!-- Back Button with better styling -->
    <div class="mt-6 text-center">
      <button
        @click="previousScreen()"
        class="inline-flex items-center text-gray-600 hover:text-[#015e73] font-medium transition-colors duration-200 group cursor-pointer"
      >
        <svg
          class="w-5 h-5 mr-2 transform group-hover:-translate-x-1 transition-transform"
          fill="none"
          stroke="currentColor"
          viewBox="0 0 24 24"
        >
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
        </svg>
        <span>Voltar ao passo anterior</span>
      </button>
    </div>
  </div>
</div>