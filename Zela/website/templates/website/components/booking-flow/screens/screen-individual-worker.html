{% load static %}

<!-- Individual Worker Screen -->
<div class="min-h-screen bg-white flex flex-col">
  <!-- Sticky Header with Progress -->
  <div class="sticky top-0 z-50 bg-white border-b border-gray-200 p-6">
    <div class="flex items-center justify-between">
      <div class="flex items-center">
        <img src="{% static 'zela-logo.png' %}" alt="Zela" class="w-10 h-10" />
        <span class="ml-3 text-xl font-bold" style="color: #011e41">Zela</span>
      </div>

      <!-- Progress Bar -->
      <div class="flex-1 max-w-md mx-auto">
        <div class="flex items-start justify-between mb-4">
          <div class="flex items-center">
            <div
              class="w-8 h-8 bg-[#015e73] text-white rounded-full flex items-center justify-center text-sm font-bold"
            >
              1
            </div>
            <div class="ml-2 text-sm font-medium" style="color: #011e41">
              Details
            </div>
          </div>
          <div class="flex items-center">
            <div
              class="w-8 h-8 bg-[#015e73] text-white rounded-full flex items-center justify-center text-sm font-bold"
            >
              2
            </div>
            <div class="ml-2 text-sm font-medium" style="color: #011e41">
              Worker
            </div>
          </div>
          <div class="flex items-center">
            <div
              class="w-8 h-8 bg-gray-200 text-gray-600 rounded-full flex items-center justify-center text-sm font-bold"
            >
              3
            </div>
            <div class="ml-2 text-sm text-gray-600">Payment</div>
          </div>
        </div>
        <div class="w-full bg-gray-200 rounded-full h-2">
          <div
            class="bg-[#015e73] h-2 rounded-full"
            style="width: 66.66%"
          ></div>
        </div>
      </div>

      <div class="flex items-center space-x-4">
        <div
          @click="window.location.href = '/dashboard/'"
          class="w-10 h-10 bg-[#015e73] rounded-full flex items-center justify-center text-white font-bold cursor-pointer hover:bg-[#014a5a] transition-colors"
        >
          JG
        </div>
      </div>
    </div>
  </div>

  <!-- Main Content with Sticky Sidebar -->
  <div class="flex flex-1 max-w-7xl mx-auto w-full">
    <!-- Sticky Left Column - Booking Details -->
    <div
      class="w-80 flex-shrink-0 sticky top-0 h-screen overflow-y-auto px-6 py-8 space-y-6"
    >
      <!-- Booking Details -->
      <div class="bg-white border border-gray-200 rounded-2xl p-6">
        <h3 class="text-lg font-bold mb-4" style="color: #011e41">
          Booking Details
        </h3>

        <!-- Pricing Display -->
        <div class="bg-gray-900 text-white rounded-2xl p-4">
          <div class="flex justify-between items-center mb-2">
            <div class="text-2xl font-bold" x-text="booking.details.duration">
              6
            </div>
            <div
              class="text-2xl font-bold"
              x-text="formatCurrency(booking.pricing.bookingCost)"
            >
              R340
            </div>
          </div>
          <div class="flex justify-between text-sm text-gray-300">
            <div>Total. hours</div>
            <div>Booking Price</div>
          </div>
        </div>
      </div>

      <!-- Location & Service Details -->
      <div class="bg-white border border-gray-200 rounded-2xl p-6">
        <!-- Location -->
        <div class="flex items-center justify-between mb-4">
          <div>
            <div class="text-sm text-gray-600 mb-1">Where:</div>
            <div class="text-sm font-medium" style="color: #011e41">
              45 Lodewyk Rd, Newfields, Cape ...
            </div>
          </div>
          <button class="text-gray-400 hover:text-gray-600 cursor-pointer">
            <svg
              class="w-4 h-4"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"
              />
            </svg>
          </button>
        </div>

        <!-- Service Type -->
        <div class="flex items-center justify-between mb-4">
          <div>
            <div class="text-sm text-gray-600 mb-1">What:</div>
            <div class="text-sm font-medium" style="color: #011e41">
              Indoor Cleaning
            </div>
          </div>
          <button class="text-gray-400 hover:text-gray-600 cursor-pointer">
            <svg
              class="w-4 h-4"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"
              />
            </svg>
          </button>
        </div>

        <!-- When -->
        <div class="flex items-center justify-between">
          <div>
            <div class="text-sm text-gray-600 mb-1">When:</div>
            <div class="text-sm font-medium" style="color: #011e41">
              Mon 7 Jul @ 07:00
            </div>
          </div>
          <button class="text-gray-400 hover:text-gray-600 cursor-pointer">
            <svg
              class="w-4 h-4"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"
              />
            </svg>
          </button>
        </div>
      </div>

      <!-- Selected Worker -->
      <div class="bg-white border border-gray-200 rounded-2xl p-6 text-center">
        <div
          class="w-16 h-16 bg-gray-300 rounded-full mx-auto mb-3 overflow-hidden"
        >
          <img
            src="{% static 'beatriz.webp' %}"
            alt="Memory Mudede"
            class="w-full h-full object-cover"
          />
        </div>
        <div class="text-lg font-bold mb-2" style="color: #011e41">
          Memory Mudede
        </div>
        <div class="flex items-center justify-center mb-2">
          <svg
            class="w-4 h-4 text-[#015e73] mr-1"
            fill="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              d="M12 17.27L18.18 21L16.54 13.97L22 9.24L14.81 8.63L12 2L9.19 8.63L2 9.24L7.46 13.97L5.82 21L12 17.27Z"
            />
          </svg>
          <span class="text-sm font-medium" style="color: #011e41"
            >98% Recommend</span
          >
        </div>
        <div class="text-sm text-gray-600">423 Jobs Completed</div>
      </div>
    </div>

    <!-- Scrollable Right Column - Tip & Payment -->
    <div class="flex-1 overflow-y-auto px-6 py-8">
      <div class="max-w-2xl mx-auto">
        <!-- Tip Section -->
        <div class="bg-white border border-gray-200 rounded-2xl p-6 mb-8">
          <!-- Tip Header -->
          <div
            class="bg-gray-900 text-white rounded-2xl p-4 mb-6 flex items-center"
          >
            <div
              class="w-16 h-16 bg-gray-300 rounded-full mr-4 overflow-hidden flex-shrink-0"
            >
              <img
                src="{% static 'beatriz.webp' %}"
                alt="Memory Mudede"
                class="w-full h-full object-cover"
              />
            </div>
            <div>
              <div class="text-lg text-gray-300 mb-1">An upfront tip for</div>
              <div class="text-2xl font-bold">Memory Mudede</div>
            </div>
          </div>

          <!-- Tip Amount Selection -->
          <div class="mb-6">
            <h4 class="text-lg font-bold mb-4" style="color: #011e41">
              Tip amount
            </h4>
            <div class="flex flex-wrap gap-3">
              <button
                onclick="selectTip(0)"
                class="px-6 py-3 rounded-full border-2 font-medium transition-colors border-[#015e73] bg-[#015e73]/10 text-[#015e73]"
                id="tip-0"
              >
                R0
              </button>
              <button
                onclick="selectTip(25)"
                class="px-6 py-3 rounded-full border-2 font-medium transition-colors border-gray-300 text-gray-700 hover:border-gray-400"
                id="tip-25"
              >
                R25
              </button>
              <button
                onclick="selectTip(50)"
                class="px-6 py-3 rounded-full border-2 font-medium transition-colors border-gray-300 text-gray-700 hover:border-gray-400"
                id="tip-50"
              >
                R50
              </button>
              <button
                onclick="selectTip(75)"
                class="px-6 py-3 rounded-full border-2 font-medium transition-colors border-gray-300 text-gray-700 hover:border-gray-400"
                id="tip-75"
              >
                R75
              </button>
              <button
                onclick="selectTip(100)"
                class="px-6 py-3 rounded-full border-2 font-medium transition-colors border-gray-300 text-gray-700 hover:border-gray-400"
                id="tip-100"
              >
                R100
              </button>
              <button
                onclick="showCustomTip()"
                class="px-6 py-3 rounded-full border-2 border-gray-300 text-gray-700 hover:border-gray-400 font-medium transition-colors"
              >
                <span class="text-[#015e73]">Custom</span><br />
                <span class="text-sm text-gray-500">amount</span>
              </button>
            </div>
          </div>
        </div>

        <!-- Price Breakdown -->
        <div class="bg-white border border-gray-200 rounded-2xl p-6 mb-8">
          <h3 class="text-2xl font-bold mb-6" style="color: #011e41">
            Price Breakdown
          </h3>

          <!-- Booking Cost -->
          <div class="mb-6">
            <h4 class="text-lg font-bold mb-4" style="color: #011e41">
              Booking Cost
            </h4>
            <div class="flex justify-between items-center">
              <div>
                <div class="font-medium" style="color: #011e41">Mon</div>
                <div class="text-sm text-gray-600">6 hrs @ 07:00</div>
              </div>
              <div class="text-lg font-bold" style="color: #011e41">R340</div>
            </div>
          </div>

          <!-- Other Costs -->
          <div class="mb-6">
            <div class="flex justify-between items-center mb-4">
              <div class="flex items-center">
                <span class="text-lg font-bold" style="color: #011e41"
                  >Other Costs</span
                >
                <button class="ml-2 text-gray-400 hover:text-gray-600">
                  <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                    <path
                      d="M12,2C6.48,2 2,6.48 2,12C2,17.52 6.48,22 12,22C17.52,22 22,17.52 22,12C22,6.48 17.52,2 12,2ZM13,17H11V11H13V17ZM13,9H11V7H13V9Z"
                    />
                  </svg>
                </button>
              </div>
              <div class="text-lg font-bold" style="color: #011e41">R60</div>
            </div>

            <!-- Booking Cover -->
            <div class="flex justify-between items-center mb-3">
              <div class="flex items-center">
                <span class="text-base" style="color: #011e41"
                  >Booking Cover</span
                >
                <button class="ml-2 text-gray-400 hover:text-gray-600">
                  <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                    <path
                      d="M12,2C6.48,2 2,6.48 2,12C2,17.52 6.48,22 12,22C17.52,22 22,17.52 22,12C22,6.48 17.52,2 12,2ZM13,17H11V11H13V17ZM13,9H11V7H13V9Z"
                    />
                  </svg>
                </button>
                <div class="ml-4 relative">
                  <input
                    type="checkbox"
                    id="bookingCover"
                    class="sr-only"
                    checked
                    onchange="toggleBookingCover(this.checked)"
                  />
                  <label
                    for="bookingCover"
                    class="flex items-center cursor-pointer"
                  >
                    <div
                      id="bookingCoverToggle"
                      class="w-12 h-6 bg-[#015e73] rounded-full relative transition-colors"
                    >
                      <div
                        id="bookingCoverSlider"
                        class="w-5 h-5 bg-white rounded-full absolute top-0.5 transition-transform translate-x-6"
                      ></div>
                    </div>
                    <span
                      id="bookingCoverLabel"
                      class="ml-2 text-sm font-medium text-white bg-[#015e73] px-2 py-1 rounded"
                    >
                      Yes
                    </span>
                  </label>
                </div>
              </div>
              <div class="text-base font-medium" style="color: #011e41">
                R21
              </div>
            </div>

            <!-- Service Fee -->
            <div class="flex justify-between items-center">
              <span class="text-base" style="color: #011e41">Service Fee</span>
              <div class="text-base font-medium" style="color: #011e41">
                R39
              </div>
            </div>
          </div>

          <!-- Booking Total -->
          <div class="border-t border-gray-200 pt-4 mb-6">
            <div class="flex justify-between items-center">
              <span class="text-lg font-bold" style="color: #011e41"
                >Booking Total</span
              >
              <div class="text-lg font-bold" style="color: #011e41">R400</div>
            </div>
          </div>

          <!-- SweepCred Wallet -->
          <div class="flex justify-between items-center mb-6">
            <span class="text-lg font-bold" style="color: #011e41"
              >Use SweepCred Wallet</span
            >
            <div class="relative">
              <input
                type="checkbox"
                id="sweepCredWallet"
                class="sr-only"
                onchange="toggleSweepCred(this.checked)"
              />
              <label
                for="sweepCredWallet"
                class="flex items-center cursor-pointer"
              >
                <div
                  id="sweepCredToggle"
                  class="w-12 h-6 rounded-full relative transition-colors bg-orange-300"
                >
                  <div
                    id="sweepCredSlider"
                    class="w-5 h-5 bg-white rounded-full absolute top-0.5 transition-transform translate-x-0.5"
                  ></div>
                </div>
                <span
                  id="sweepCredLabel"
                  class="ml-2 text-sm font-medium text-white px-2 py-1 rounded bg-orange-300"
                >
                  No
                </span>
              </label>
            </div>
          </div>

          <!-- Total Due -->
          <div class="border-t border-gray-200 pt-4">
            <div class="flex justify-between items-center">
              <div class="flex items-center">
                <span class="text-xl font-bold" style="color: #011e41"
                  >TOTAL DUE</span
                >
                <button class="ml-2 text-gray-400 hover:text-gray-600">
                  <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 24 24">
                    <path
                      d="M12,2C6.48,2 2,6.48 2,12C2,17.52 6.48,22 12,22C17.52,22 22,17.52 22,12C22,6.48 17.52,2 12,2ZM13,17H11V11H13V17ZM13,9H11V7H13V9Z"
                    />
                  </svg>
                </button>
              </div>
              <div class="text-xl font-bold" style="color: #011e41">R400</div>
            </div>
          </div>
        </div>

        <!-- Action Buttons -->
        <div class="flex space-x-4">
          <button
            onclick="console.log('Proceed to Payment clicked'); proceedToPayment();"
            class="flex-1 bg-[#015e73] text-white font-bold py-4 px-6 rounded-2xl hover:bg-[#014a5a] transition-colors"
          >
            Proceed to Payment Method
          </button>
          <button
            onclick="console.log('Back clicked'); goBack();"
            class="flex-1 bg-white border-2 border-gray-300 text-gray-700 font-bold py-4 px-6 rounded-2xl hover:bg-gray-50 transition-colors"
          >
            Back
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Individual Worker Screen Functions -->
<script>
  // Tip selection functionality
  function selectTip(amount) {
    // Update the main booking data
    const component = Alpine.findClosest(document.body, "[x-data]");
    if (
      component &&
      component._x_dataStack &&
      component._x_dataStack[0].booking
    ) {
      component._x_dataStack[0].booking.tip.amount = amount;
    }

    // Update UI to show selected tip
    document.querySelectorAll('[id^="tip-"]').forEach((btn) => {
      btn.className =
        "px-6 py-3 rounded-full border-2 font-medium transition-colors border-gray-300 text-gray-700 hover:border-gray-400";
    });

    document.getElementById(`tip-${amount}`).className =
      "px-6 py-3 rounded-full border-2 font-medium transition-colors border-[#015e73] bg-[#015e73]/10 text-[#015e73]";
  }

  function showCustomTip() {
    // Handle custom tip input
    const customAmount = prompt("Enter custom tip amount (R):");
    if (customAmount && !isNaN(customAmount)) {
      selectTip(parseInt(customAmount));
    }
  }

  function toggleBookingCover(isChecked) {
    const toggle = document.getElementById("bookingCoverToggle");
    const slider = document.getElementById("bookingCoverSlider");
    const label = document.getElementById("bookingCoverLabel");

    if (isChecked) {
      toggle.className =
        "w-12 h-6 bg-[#015e73] rounded-full relative transition-colors";
      slider.className =
        "w-5 h-5 bg-white rounded-full absolute top-0.5 transition-transform translate-x-6";
      label.className =
        "ml-2 text-sm font-medium text-white bg-[#015e73] px-2 py-1 rounded";
      label.textContent = "Yes";
    } else {
      toggle.className =
        "w-12 h-6 bg-gray-300 rounded-full relative transition-colors";
      slider.className =
        "w-5 h-5 bg-white rounded-full absolute top-0.5 transition-transform translate-x-0.5";
      label.className =
        "ml-2 text-sm font-medium text-white bg-gray-300 px-2 py-1 rounded";
      label.textContent = "No";
    }
  }

  function toggleSweepCred(isChecked) {
    const toggle = document.getElementById("sweepCredToggle");
    const slider = document.getElementById("sweepCredSlider");
    const label = document.getElementById("sweepCredLabel");

    if (isChecked) {
      toggle.className =
        "w-12 h-6 rounded-full relative transition-colors bg-[#015e73]";
      slider.className =
        "w-5 h-5 bg-white rounded-full absolute top-0.5 transition-transform translate-x-6";
      label.className =
        "ml-2 text-sm font-medium text-white px-2 py-1 rounded bg-[#015e73]";
      label.textContent = "Yes";
    } else {
      toggle.className =
        "w-12 h-6 rounded-full relative transition-colors bg-orange-300";
      slider.className =
        "w-5 h-5 bg-white rounded-full absolute top-0.5 transition-transform translate-x-0.5";
      label.className =
        "ml-2 text-sm font-medium text-white px-2 py-1 rounded bg-orange-300";
      label.textContent = "No";
    }
  }
</script>
